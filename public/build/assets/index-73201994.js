import{m as w}from"./index-ce65fae0.js";import{L as N,Q as J,X as M,a as s,K as D,P as H,aq as I,aJ as z,k as W,T as Q,aK as X,G as S,r as Y,o as p,c as y,w as o,E as Z,e as c,F as $,h as F,V as T,f,t as ee,b as i,i as A,d as le,a0 as ae}from"./main-2d870a4f.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import{V as te}from"./VOverlay-6d2e6dab.js";import{V as B,d as r,e as oe,b as ie,c as U}from"./VRow-572c6eef.js";import{V as ne,a as b}from"./VTabs-c4fd0ac4.js";import{V as re,a as de,b as g}from"./VWindowItem-6d0a304f.js";import{V as ue}from"./VSpacer-6b5d3e8a.js";import{b as me,c as j,d as pe,a as V,V as ce}from"./VTextField-b26969d8.js";import{V as fe}from"./VDialog-c6e1eb93.js";import{V as v}from"./VDivider-8ee8bee7.js";import{V as R}from"./VCheckbox-cf1e9c5c.js";import{m as he,a as O,b as ge,c as Fe}from"./VCheckboxBtn-edb42a40.js";import"./VImg-750160b0.js";import"./VChip-99b7f6cd.js";import"./dialog-transition-5e1da3ef.js";const ye={computed:{formattedPlafon:{get(){return this.formatNumber(this.dataForm.plafon)},set(l){this.dataForm.plafon=l.replace(/\D/g,"")}},formattedMaxPlafon:{get(){return this.formatNumber(this.dataForm.plafon)},set(l){this.dataForm.plafon=l.replace(/\D/g,"")}}},data(){return{selectedOption:"",overlay:!1,insert:!1,searchValue:"",userData:null,userToken:null,uploadProgress:null,tab:0,rules:{required:l=>!!l||"Required"},items:[],originalItems:[],userAccess:null,headers:[{text:"Nama",value:"name",sortable:!0},{text:"Plafon",value:"plafon",sortable:!0},{text:"Status",value:"isApproved",sortable:!0},{text:"Operation",value:"operation"}],phases:[{value:0},{value:1},{value:2},{value:3},{value:4}],dataForm:{id:null,name:"",plafon:null,type_bussiness:null,desc_bussiness:null,file1:null,hasFile2:!1,file2:null,hasFile3:!1,file3:null,file4:null,file5:null,hasFile7:!1,file7:null,hasFile8:!1,file8:null,hasFile9:!1,file9:null,hasFile10:!1,file10:null},isStatusPhase:!1,statusPhase:0}},watch:{tab(l){l==1?this.filterDataStatus(1):l==2?this.filterDataStatus(2):l==3?this.filterDataStatus(3):this.items=[...this.originalItems]}},methods:{formatInput(l){return l=l.replace(/\D/g,""),l=l.replace(/\B(?=(\d{3})+(?!\d))/g,","),l},toDetail(l){this.$router.push(`/u-credit/${l.id}`)},async deleteFile(l){try{if(this.overlay=!0,!window.confirm("Apakah Anda yakin ingin menghapus data? Semua Data akan terhapus secara permanen."))return;const d=await w.delete(`/user/credit/${l.id}`);d.status===200?(this.overlay=!1,this.getAllFiles(),this.$showToast("success","Berhasill",d.data.message)):(this.overlay=!1,this.getAllFiles(),this.$showToast("error","Sorry",d.data.message))}catch(e){this.overlay=!1,this.getAllFiles(),this.$showToast("error","Sorry",e.response.data.message)}},resetFile(l){!this.dataForm[l]!=null&&(this.dataForm[l]=null)},handleFileChange(l,e){const d=l.target.files[0];d&&["image/jpeg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(d.type)?(this.dataForm[e]=d,e=="file1"?this.dataForm.noteFile1="KTP Pemohon":e=="file2"?this.dataForm.noteFile2="KTP Pasangan":e=="file3"?this.dataForm.noteFile3="KTP Atas Nama Jaminan":e=="file4"?this.dataForm.noteFile4="Kartu Keluarga":e=="file5"?this.dataForm.noteFile5="Buku Nikah":e=="file7"?this.dataForm.noteFile7="Jaminan SHM":e=="file8"?this.dataForm.noteFile8="Jaminan BPKB":e=="file9"?this.dataForm.noteFile9="Foto Detail Mesin":e=="file10"&&(this.dataForm.noteFile10="Foto Kunjungan")):(this.$showToast("error","Error","Hanya file JPG, JPEG, PNG, dan PDF, WORD yang diizinkan."),l.target.value=null)},async openModal(l,e=null){l===1?this.insert=!0:l===2&&console.log("masuk")},closeModal(l){l===1?(this.resetForm(),this.insert=!1):l===2&&(this.resetForm(),this.edit=!1)},resetForm(){this.dataForm={id:null,name:"",plafon:null,file1:null,hasFile2:!1,file2:null,hasFile3:!1,file3:null,file4:null,file5:null,hasFile7:!1,file7:null,hasFile8:!1,file8:null,hasFile9:!1,file9:null,hasFile10:!1,file10:null}},formatInputIn(l){let e=l.target.value;e=e.replace(/\D/g,""),e=e.replace(/\B(?=(\d{3})+(?!\d))/g,","),l.target.value=e},formatNumber(l){return l?l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):""},filterDataStatus(l){this.items=this.originalItems.filter(e=>e.isApproved==l)},getUserData(){const l=localStorage.getItem("userData");l&&(this.userData=JSON.parse(l))},async getAllFiles(){try{const l=await w.get("/user/credit");l.status===200?(this.items=l.data.data.files,this.userAccess=l.data.data.userAccess,this.originalItems=[...this.items]):this.$showToast("error","Sorry",l.data.data.message)}catch(l){this.$showToast("error","Sorry",l.response.data.message)}},formatInputPlafon(l){let e=l.target.value;e=e.replace(/\D/g,""),e=e.replace(/\B(?=(\d{3})+(?!\d))/g,","),l.target.value=e},async insertData(){try{this.overlay=!0;const l=new FormData;l.append("name",this.dataForm.name),l.append("plafon",this.dataForm.plafon.replace(/\D/g,"")),l.append("type_bussiness",this.dataForm.type_bussiness),l.append("desc_bussiness",this.dataForm.desc_bussiness);for(let u=1;u<=10;u++){if(u===6)continue;let a="file"+u,n="noteFile"+u,h="hasFile"+u;this.dataForm.hasOwnProperty(h)&&this.dataForm[h]||this.dataForm[a]?this.dataForm[a]&&(l.append(a,this.dataForm[a]),l.append(n,this.dataForm[n])):this.dataForm[a]&&l.append(a,this.dataForm[a])}l.append("_method","POST");const e={onUploadProgress:u=>{try{this.uploadProgress=Math.round(u.loaded*100/u.total)}catch(a){console.error("Error calculating progress:",a)}},headers:{"Content-Type":"multipart/form-data"}},d=await w.post("/user/credit",l,e);d.status===200?(this.overlay=!1,this.closeModal(1),this.getAllFiles(),this.uploadProgress=null,this.$showToast("success","Success",d.data.message)):(this.overlay=!1,this.uploadProgress=null,this.getAllFiles(),this.$showToast("error","Sorry",d.data.message))}catch(l){this.overlay=!1,this.uploadProgress=null,this.closeModal(1),this.getAllFiles(),this.$showToast("error","Sorry",l.response.data.message)}}},mounted(){this.getAllFiles(),this.getUserData()}},Ve=N({...he({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),C=J()({name:"VRadio",props:Ve(),setup(l,e){let{slots:d}=e;return M(()=>s(O,D(l,{class:["v-radio",l.class],style:l.style,type:"radio"}),d)),{}}});const be=N({height:{type:[Number,String],default:"auto"},...me(),...H(ge(),["multiple"]),trueIcon:{type:I,default:"$radioOn"},falseIcon:{type:I,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ve=J()({name:"VRadioGroup",inheritAttrs:!1,props:be(),emits:{"update:modelValue":l=>!0},setup(l,e){let{attrs:d,slots:u}=e;const a=z(),n=W(()=>l.id||`radio-group-${a}`),h=Q(l,"modelValue");return M(()=>{const[t,m]=X(d),_=j.filterProps(l),q=O.filterProps(l),x=u.label?u.label({label:l.label,props:{for:n.value}}):l.label;return s(j,D({class:["v-radio-group",l.class],style:l.style},t,_,{modelValue:h.value,"onUpdate:modelValue":P=>h.value=P,id:n.value}),{...u,default:P=>{let{id:k,messagesId:K,isDisabled:G,isReadonly:L}=P;return s(S,null,[x&&s(pe,{id:k.value},{default:()=>[x]}),s(Fe,D(q,{id:k.value,"aria-describedby":K.value,defaultsTarget:"VRadio",trueIcon:l.trueIcon,falseIcon:l.falseIcon,type:l.type,disabled:G.value,readonly:L.value,"aria-labelledby":x?k.value:void 0,multiple:!1},m,{modelValue:h.value,"onUpdate:modelValue":E=>h.value=E}),u)])}})}),{}}}),_e=i("br",null,null,-1),xe=i("span",{class:"font-weight-bold text-lg"},"Loading....",-1),Pe=i("p",null,"Data Kosong",-1),ke=i("p",null,"loading data .....",-1),we={key:0},Ce={key:1},De={key:2},Se={class:"operation-wrapper"},Ie=["onClick"],Te=i("span",{style:{color:"red"}},"*",-1),Ae=i("span",{class:"subtitle-1 text-center"},"Nama Pemohon: ",-1),Be=i("span",{style:{color:"red"}},"*",-1),Ue=i("span",{class:"subtitle-1 text-center"},"Jumlah Plafon: ",-1),je=i("span",{style:{color:"red"}},"*",-1),Re=i("span",{class:"subtitle-1 text-center"},"KTP Pemohon : ",-1),Ne=i("span",{style:{color:"red"}},"*",-1),Je=i("span",{class:"subtitle-1 text-center"},"Kartu Keluarga : ",-1),Me=i("span",{style:{color:"red"}},"*",-1),Oe=i("span",{class:"subtitle-1 text-center"},"Foto Kunjungan : ",-1),qe=i("span",{style:{color:"red"}},"*",-1),Ke=i("span",{class:"subtitle-1 text-center"},"KTP Pasangan Pemohon : ",-1),Ge=i("span",{style:{color:"red"}},"*",-1),Le=i("span",{class:"subtitle-1 text-center"},"Pilih Salah Satu Kelengkapan : ",-1),Ee=i("span",{style:{color:"red"}},"*",-1),He=i("span",{class:"subtitle-1 text-center"},"Buku Nikah:",-1),ze=i("span",{style:{color:"red"}},"*",-1),We=i("span",{class:"subtitle-1 text-center"},"Jaminan SHM:",-1),Qe=i("span",{style:{color:"red"}},"*",-1),Xe=i("span",{class:"subtitle-1 text-center"},"Jaminan BPKB:",-1),Ye=i("span",{style:{color:"red"}},"*",-1),Ze=i("span",{class:"subtitle-1 text-center"},"KTP atas nama Jaminan : ",-1),$e=i("span",{style:{color:"red"}},"*",-1),el=i("span",{class:"subtitle-1 text-center"},"Jenis Usaha: ",-1),ll=i("span",{style:{color:"red"}},"*",-1),al=i("span",{class:"subtitle-1 text-center"},"Deskripsi Usaha: ",-1);function sl(l,e,d,u,a,n){const h=Y("EasyDataTable");return p(),y(S,null,[s(te,{absolute:!0,modelValue:a.overlay,"onUpdate:modelValue":e[0]||(e[0]=t=>a.overlay=t),contained:"",persistent:"",class:"align-center justify-center"},{default:o(()=>[s(r,null,{default:o(()=>[s(Z,{color:"primary",size:"32",indeterminate:""}),_e,xe]),_:1})]),_:1},8,["modelValue"]),s(B,null,{default:o(()=>[s(oe,{class:"text-2xl font-weight-bold d-flex justify-left"},{default:o(()=>[c(" List Credit ")]),_:1}),s(ne,{modelValue:a.tab,"onUpdate:modelValue":e[1]||(e[1]=t=>a.tab=t),class:"v-tabs-pill","bg-color":"secondary"},{default:o(()=>[s(b,{value:"0"},{default:o(()=>[c("Semua")]),_:1}),s(b,{value:"1"},{default:o(()=>[c("Approved")]),_:1}),s(b,{value:"2"},{default:o(()=>[c("Pending")]),_:1}),s(b,{value:"3"},{default:o(()=>[c("Rejected")]),_:1})]),_:1},8,["modelValue"]),s(ie,null,{default:o(()=>[s(re,{modelValue:a.tab,"onUpdate:modelValue":e[4]||(e[4]=t=>a.tab=t)},{default:o(()=>[(p(!0),y(S,null,$(a.phases,t=>(p(),F(de,{value:t.value},{default:o(()=>[s(U,{class:"d-flex justify-end pa-3"},{default:o(()=>[a.userAccess&&parseInt(a.userAccess.canInsertData)?(p(),F(T,{key:0,color:"primary",size:"small",class:"my-3 mx-3",onClick:e[2]||(e[2]=m=>n.openModal(1))},{default:o(()=>[c(" Tambah Data ")]),_:1})):f("",!0),s(ue),s(V,{"prepend-inner-icon":"mdi-magnify",density:"compact",label:"Search","single-line":"",flat:"","hide-details":"",variant:"solo-filled",modelValue:a.searchValue,"onUpdate:modelValue":e[3]||(e[3]=m=>a.searchValue=m)},null,8,["modelValue"])]),_:1}),s(h,{"show-index":"",headers:a.headers,items:a.items,"search-value":a.searchValue},{"empty-message":o(()=>[Pe]),loading:o(()=>[ke]),"item-plafon":o(m=>[c("Rp. "+ee(n.formatInput(m.plafon))+",-",1)]),"item-isApproved":o(m=>[parseInt(m.isApproved)==1?(p(),y("span",we," Approved")):f("",!0),parseInt(m.isApproved)==2?(p(),y("span",Ce," Pending")):f("",!0),parseInt(m.isApproved)==3?(p(),y("span",De," Rejected")):f("",!0)]),"item-operation":o(m=>[i("div",Se,[i("button",null,[s(A,{size:"20",icon:"bx-file-find",color:"blue",onClick:_=>n.toDetail(m)},null,8,["onClick"])]),c("   "),a.userData&&m.user_id==a.userData.id?(p(),y("button",{key:0,onClick:_=>n.deleteFile(m)},[s(A,{size:"20",icon:"bx-trash",color:"red"})],8,Ie)):f("",!0)])]),_:1},8,["headers","items","search-value"])]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),s(fe,{modelValue:a.insert,"onUpdate:modelValue":e[24]||(e[24]=t=>a.insert=t),width:"auto",persistent:"",transition:"dialog-top-transition"},{default:o(()=>[s(B,null,{title:o(()=>[c(" Tambah Data s")]),text:o(()=>[s(ce,{onSubmit:le(n.insertData,["prevent"])},{default:o(()=>[s(U,null,{default:o(()=>[s(r,{md:"12",cols:"12"},{default:o(()=>[Te,Ae,s(V,{class:"my-3",modelValue:a.dataForm.name,"onUpdate:modelValue":e[5]||(e[5]=t=>a.dataForm.name=t),autofocus:"",rules:[a.rules.required]},null,8,["modelValue","rules"])]),_:1}),s(r,{md:"12",cols:"12"},{default:o(()=>[Be,Ue,s(V,{class:"my-3",modelValue:n.formattedPlafon,"onUpdate:modelValue":e[6]||(e[6]=t=>n.formattedPlafon=t),type:"text",onInput:n.formatInputIn},null,8,["modelValue","onInput"])]),_:1}),s(r,{md:"12",cols:"12"},{default:o(()=>[je,Re,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[7]||(e[7]=t=>n.handleFileChange(t,"file1"))},null,8,["rules"])]),_:1}),s(r,{md:"12",cols:"12"},{default:o(()=>[Ne,Je,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[8]||(e[8]=t=>n.handleFileChange(t,"file4"))},null,8,["rules"])]),_:1}),s(r,{md:"12",cols:"12"},{default:o(()=>[Me,Oe,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[9]||(e[9]=t=>n.handleFileChange(t,"file10"))},null,8,["rules"])]),_:1}),s(v,{thickness:5}),s(r,{cols:"12",md:"12"},{default:o(()=>[s(R,{modelValue:a.dataForm.hasFile2,"onUpdate:modelValue":e[10]||(e[10]=t=>a.dataForm.hasFile2=t),label:"Apakah pemohon sudah menikah?",onChange:e[11]||(e[11]=t=>(n.resetFile("file2"),n.resetFile("file5")))},null,8,["modelValue"])]),_:1}),s(v,{thickness:5}),a.dataForm.hasFile2?(p(),F(r,{key:0,md:"12",cols:"12"},{default:o(()=>[qe,Ke,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[12]||(e[12]=t=>n.handleFileChange(t,"file2"))},null,8,["rules"])]),_:1})):f("",!0),s(r,{md:"12",cols:"12"},{default:o(()=>[Ge,Le,s(ve,{modelValue:a.selectedOption,"onUpdate:modelValue":e[13]||(e[13]=t=>a.selectedOption=t),mandatory:!0,row:""},{default:o(()=>[s(C,{label:"Buku Nikah",value:"bukuNikah"}),s(C,{label:"Jenis Jaminan SHM",value:"jaminanSHM"}),s(C,{label:"Jenis Jaminan BPKB",value:"jaminanBPKB"})]),_:1},8,["modelValue"])]),_:1}),a.selectedOption==="bukuNikah"?(p(),F(r,{key:1,md:"12",cols:"12"},{default:o(()=>[Ee,He,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[14]||(e[14]=t=>{n.handleFileChange(t,"file5"),n.resetFile("file7"),n.resetFile("file8")})},null,8,["rules"])]),_:1})):f("",!0),a.selectedOption==="jaminanSHM"?(p(),F(r,{key:2,md:"12",cols:"12"},{default:o(()=>[ze,We,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[15]||(e[15]=t=>{n.handleFileChange(t,"file7"),n.resetFile("file5"),n.resetFile("file8")})},null,8,["rules"])]),_:1})):f("",!0),a.selectedOption==="jaminanBPKB"?(p(),F(r,{key:3,md:"12",cols:"12"},{default:o(()=>[Qe,Xe,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[16]||(e[16]=t=>{n.handleFileChange(t,"file8"),n.resetFile("file5"),n.resetFile("file7")})},null,8,["rules"])]),_:1})):f("",!0),s(v,{thickness:5}),s(r,{cols:"12",md:"12"},{default:o(()=>[s(R,{modelValue:a.dataForm.hasFile3,"onUpdate:modelValue":e[17]||(e[17]=t=>a.dataForm.hasFile3=t),label:"Apakah agunan bukan atas nama pemohon?",onChange:e[18]||(e[18]=t=>n.resetFile("file3"))},null,8,["modelValue"])]),_:1}),a.dataForm.hasFile3?(p(),F(r,{key:4,md:"12",cols:"12"},{default:o(()=>[Ye,Ze,s(g,{class:"my-3",accept:"image/jpeg,image/png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",placeholder:"Pick an image",rules:[a.rules.required],onChange:e[19]||(e[19]=t=>n.handleFileChange(t,"file3"))},null,8,["rules"])]),_:1})):f("",!0),s(v,{thickness:5}),s(r,{md:"12",cols:"12"},{default:o(()=>[$e,el,s(V,{class:"my-3",modelValue:a.dataForm.type_bussiness,"onUpdate:modelValue":e[20]||(e[20]=t=>a.dataForm.type_bussiness=t),rules:[a.rules.required]},null,8,["modelValue","rules"])]),_:1}),s(r,{md:"12",cols:"12"},{default:o(()=>[ll,al,s(V,{class:"my-3",modelValue:a.dataForm.desc_bussiness,"onUpdate:modelValue":e[21]||(e[21]=t=>a.dataForm.desc_bussiness=t),rules:[a.rules.required]},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:o(()=>[s(T,{type:"submit",disabled:a.dataForm.name==null||a.dataForm.plafon==null||a.dataForm.type_bussiness==null||a.dataForm.desc_bussiness==null||a.dataForm.file1==null||a.dataForm.file4==null||a.dataForm.file10==null||a.dataForm.file5==null&&a.dataForm.file7==null&&a.dataForm.file8==null},{default:o(()=>[c(" Simpan ")]),_:1},8,["disabled"]),i("button",{type:"button",class:"btn btn-blue",onClick:e[22]||(e[22]=t=>n.closeModal(1))}," Batal ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),actions:o(()=>[s(ae,{modelValue:a.uploadProgress,"onUpdate:modelValue":e[23]||(e[23]=t=>a.uploadProgress=t),color:"amber",height:"25"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}const bl=se(ye,[["render",sl]]);export{bl as default};
