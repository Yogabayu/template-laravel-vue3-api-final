import{m}from"./index-7fea880e.js";import{r as V,o as g,c as _,a,w as s,e as f,b as r,d as b,V as F,i as P}from"./main-50364cd1.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";import{V as p,a as v,e as w,c as y,d as n}from"./VRow-61790f64.js";import{V as T}from"./VSpacer-b6b06d50.js";import{a as u,V as S}from"./VTextField-f4a2aed6.js";import{V as C}from"./VDialog-ea0ecbb0.js";import{V as h}from"./VAutocomplete-30323409.js";import{V as D}from"./VSelect-30f6e68f.js";import"./VImg-5377d243.js";import"./VOverlay-ecef7f78.js";import"./dialog-transition-0b1f9012.js";import"./VMenu-bd315143.js";import"./VDivider-4c809598.js";import"./VCheckboxBtn-2c4f795f.js";import"./VChip-02448860.js";const I={data(){return{rules:{required:t=>!!t||"Required"},dataForm:{id:null,office_id:null,position_id:null,phase:null,minPlafon:null,maxPlafon:null},items:[],offices:[],positions:[],headers:[{text:"Nama Kantor",value:"name",sortable:!0},{text:"Total Pengaturan",value:"notification_configurations_count",sortable:!0},{text:"Operation",value:"operation"}],searchValue:"",insert:!1,edit:!1}},methods:{toDetail(t){this.$router.push(`/notifconf/${t.id}`)},formatInput(t){let e=t.target.value;e=e.replace(/\D/g,""),e=e.replace(/\B(?=(\d{3})+(?!\d))/g,","),t.target.value=e},async insertData(){try{for(let l in this.dataForm)l!=="id"&&this.dataForm[l]===null&&(this.closeModal(1),this.$showToast("error","Sorry",`Properti ${l} harus diisi.`));const t=new FormData;t.append("office_id",this.dataForm.office_id),t.append("position_id",this.dataForm.position_id),t.append("phase",this.dataForm.phase),t.append("minPlafon",this.dataForm.minPlafon.replace(/\D/g,"")),t.append("maxPlafon",this.dataForm.maxPlafon.replace(/\D/g,"")),t.append("_method","POST");const e=await m.post("/notifconf",t);e.status===200?(this.closeModal(1),this.getAllNotifConf(),this.$showToast("success","Success",e.data.message)):(this.getAllNotifConf(),this.$showToast("error","Sorry",e.data.message))}catch(t){this.getAllNotifConf(),this.$showToast("error","Sorry",t.response.data.message)}},closeModal(t){t===1?(this.resetForm(),this.insert=!1):t===2&&(this.resetForm(),this.edit=!1)},resetForm(){this.dataForm={id:null,office_id:null,position_id:null,phase:null,minPlafon:null,maxPlafon:null}},openModal(t,e=null){t===1?(this.getOffices(),this.getPositions(),this.insert=!0):t===2&&e&&(this.getOffices(),this.getPositions(),this.dataForm.id=e.id,this.dataForm.offices=e.offices.map(l=>({value:l.id,title:l.name})),this.dataForm.positions=e.positions.map(l=>({value:l.id,title:l.name})),this.dataForm.phase=e.phase,this.dataForm.minPlafon=e.minPlafon,this.dataForm.maxPlafon=e.maxPlafon,this.edit=!0)},async getAllNotifConf(){try{const t=await m.get("/notifconf");t.status===200?this.items=t.data.data:this.$showToast("error","Sorry",t.data.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}},async getOffices(){try{const t=await m.get("/office");t.status===200?this.offices=t.data.data.map(e=>({value:e.id,title:e.code+" - "+e.name})):this.$showToast("error","Sorry","error get data office")}catch{this.$showToast("error","Sorry","error get data office")}},async getPositions(){try{const t=await m.get("/position");t.status===200?this.positions=t.data.data.map(e=>({value:e.id,title:e.name})):this.$showToast("error","Sorry","error get data positions")}catch{this.$showToast("error","Sorry","error get data positions")}}},mounted(){this.getAllNotifConf()}},N={class:"d-flex justify-space-between mb-6"},M={class:"d-flex align-center pe-2 w-25"},U=r("p",null,"Data Kantor Kosong",-1),K=r("p",null,"loading data .....",-1),k={class:"operation-wrapper"};function A(t,e,l,B,o,d){const c=V("EasyDataTable");return g(),_("div",null,[a(p,{class:"auth-card pa-4 pt-5"},{default:s(()=>[a(v,{class:"align-left"},{default:s(()=>[a(w,{class:"text-2xl font-weight-bold"},{default:s(()=>[f(" Konfigurasi Fase Kredit ")]),_:1})]),_:1}),r("div",N,[a(T),r("div",M,[a(u,{"prepend-inner-icon":"mdi-magnify",density:"compact",label:"Search","single-line":"",flat:"","hide-details":"",variant:"solo-filled",modelValue:o.searchValue,"onUpdate:modelValue":e[0]||(e[0]=i=>o.searchValue=i)},null,8,["modelValue"])])]),a(C,{modelValue:o.insert,"onUpdate:modelValue":e[7]||(e[7]=i=>o.insert=i),width:"auto",persistent:"",transition:"dialog-top-transition"},{default:s(()=>[a(p,null,{title:s(()=>[f(" Tambah Data ")]),text:s(()=>[a(S,{onSubmit:b(d.insertData,["prevent"])},{default:s(()=>[a(y,null,{default:s(()=>[a(n,{cols:"12",md:"12"},{default:s(()=>[a(h,{modelValue:o.dataForm.office_id,"onUpdate:modelValue":e[1]||(e[1]=i=>o.dataForm.office_id=i),items:o.offices,hint:"Pilih Kantor",label:"Kantor",clearable:"","persistent-hint":"","prepend-icon":"mdi-divide"},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"12"},{default:s(()=>[a(h,{modelValue:o.dataForm.position_id,"onUpdate:modelValue":e[2]||(e[2]=i=>o.dataForm.position_id=i),items:o.positions,hint:"Pilih Jabatan",label:"Jabatan",clearable:"","persistent-hint":"","prepend-icon":"mdi-divide"},null,8,["modelValue","items"])]),_:1}),a(n,{md:"12",cols:"12"},{default:s(()=>[a(D,{label:"Pilih Phase",items:[{value:1,title:"Phase 1"},{value:2,title:"Phase 2"},{value:3,title:"Phase 3"},{value:4,title:"Phase 4"}],modelValue:o.dataForm.phase,"onUpdate:modelValue":e[3]||(e[3]=i=>o.dataForm.phase=i),"prepend-icon":"mdi-help-rhombus"},null,8,["modelValue"])]),_:1}),a(n,{md:"6",cols:"12"},{default:s(()=>[a(u,{label:"Minimal Plafon",modelValue:o.dataForm.minPlafon,"onUpdate:modelValue":e[4]||(e[4]=i=>o.dataForm.minPlafon=i),type:"text",onInput:d.formatInput,autofocus:"","prepend-icon":"mdi-help-rhombus"},null,8,["modelValue","onInput"])]),_:1}),a(n,{md:"6",cols:"12"},{default:s(()=>[a(u,{label:"Maximal Plafon",modelValue:o.dataForm.maxPlafon,"onUpdate:modelValue":e[5]||(e[5]=i=>o.dataForm.maxPlafon=i),type:"text",onInput:d.formatInput,autofocus:"","prepend-icon":"mdi-help-rhombus"},null,8,["modelValue","onInput"])]),_:1}),a(n,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:s(()=>[a(F,{type:"submit"},{default:s(()=>[f("Simpan")]),_:1}),r("button",{type:"button",class:"btn btn-blue",onClick:e[6]||(e[6]=i=>d.closeModal(1))}," Batal ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"]),a(c,{"show-index":"",headers:o.headers,items:o.items,"search-value":o.searchValue},{"empty-message":s(()=>[U]),loading:s(()=>[K]),"item-operation":s(i=>[r("div",k,[r("button",null,[a(P,{size:"20",icon:"bx-file-find",color:"blue",onClick:O=>d.toDetail(i)},null,8,["onClick"])])])]),_:1},8,["headers","items","search-value"])]),_:1})])}const te=x(I,[["render",A]]);export{te as default};
